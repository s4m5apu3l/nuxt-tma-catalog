# Документ требований

## Введение

TMA Catalog Bot - это Telegram Mini App, предназначенное для предоставления комплексной системы каталога товаров/услуг для аренды с административной панелью для управления контентом. Приложение будет обслуживать две основные группы пользователей: конечных пользователей, которые просматривают каталог через Telegram, и администраторов, которые управляют категориями и товарами через веб-панель администратора. Система будет поддерживать многоязычную функциональность (английский/русский) и интегрироваться с Appwrite в качестве бэкенд-сервиса и Telegram Bot API для взаимодействия с пользователями.

## Требования

### Требование 1

**Пользовательская история:** Как конечный пользователь, я хочу просматривать категории товаров в каталоге, чтобы легко найти тип товаров, которые меня интересуют для аренды.

#### Критерии приемки

1. КОГДА пользователь открывает Telegram Mini App ТО система ДОЛЖНА отображать сетку активных категорий с иконками, названиями и количеством товаров
2. КОГДА пользователь просматривает список категорий ТО система ДОЛЖНА сортировать категории по полю sortOrder в порядке возрастания
3. КОГДА пользователь выбирает категорию ТО система ДОЛЖНА перейти на страницу детализации категории, показывающую все товары в этой категории
4. КОГДА список категорий загружается ТО система ДОЛЖНА отображать анимации загрузки-скелетоны
5. ЕСЛИ активных категорий не существует ТО система ДОЛЖНА отображать соответствующее сообщение о пустом состоянии

### Требование 2

**Пользовательская история:** Как конечный пользователь, я хочу просматривать подробную информацию о конкретном товаре, чтобы принять обоснованное решение о его аренде.

#### Критерии приемки

1. КОГДА пользователь выбирает товар из категории ТО система ДОЛЖНА отображать страницу детализации товара со всей информацией о товаре
2. КОГДА просматривается страница детализации товара ТО система ДОЛЖНА отображать галерею изображений с функциональностью свайпа и лайтбокса
3. КОГДА просматриваются детали товара ТО система ДОЛЖНА показывать название товара, категорию, цену с единицей измерения, статус доступности, описание и характеристики
4. КОГДА пользователь нажимает кнопку связи ТО система ДОЛЖНА открыть чат Telegram с предзаполненным сообщением, содержащим детали товара
5. ЕСЛИ товар недоступен ТО система ДОЛЖНА отображать значок "Недоступен" на видном месте
6. КОГДА просматриваются детали товара ТО система ДОЛЖНА отображать навигацию хлебных крошек (Главная > Категория > Товар)

### Требование 3

**Пользовательская история:** Как администратор, я хочу управлять категориями товаров через веб-интерфейс, чтобы эффективно организовать структуру каталога.

#### Критерии приемки

1. КОГДА администратор получает доступ к панели администратора ТО система ДОЛЖНА проверить авторизацию через Appwrite Auth
2. КОГДА просматривается список категорий ТО система ДОЛЖНА отображать таблицу с информацией о категориях, количеством товаров и статусом
3. КОГДА создается или редактируется категория ТО система ДОЛЖНА требовать английские и русские названия как обязательные поля
4. КОГДА сохраняется категория ТО система ДОЛЖНА автоматически генерировать уникальный slug из английского названия
5. КОГДА удаляется категория с товарами ТО система ДОЛЖНА предупредить администратора и предоставить варианты переназначения товаров
6. КОГДА переупорядочиваются категории ТО система ДОЛЖНА поддерживать функциональность drag-and-drop для обновления значений sortOrder

### Требование 4

**Пользовательская история:** Как администратор, я хочу управлять товарами с подробной информацией и изображениями, чтобы предоставить пользователям исчерпывающие списки товаров.

#### Критерии приемки

1. КОГДА создается или редактируется товар ТО система ДОЛЖНА требовать английские и русские названия, выбор категории и цену как обязательные поля
2. КОГДА загружаются изображения товара ТО система ДОЛЖНА поддерживать загрузку нескольких изображений с функциональностью drag-and-drop
3. КОГДА управляются изображения товара ТО система ДОЛЖНА позволять переупорядочивание изображений и поддерживать до 10 изображений на товар
4. КОГДА сохраняется товар ТО система ДОЛЖНА проверить, что цена больше нуля и загружено хотя бы одно изображение
5. КОГДА удаляется товар ТО система ДОЛЖНА удалить связанные изображения из Appwrite Storage
6. КОГДА просматривается список товаров ТО система ДОЛЖНА предоставить фильтрацию по категории, статусу и доступности

### Требование 5

**Пользовательская история:** Как пользователь, я хочу, чтобы приложение поддерживало несколько языков, чтобы я мог использовать его на предпочитаемом языке (английский или русский).

#### Критерии приемки

1. КОГДА пользователь открывает приложение ТО система ДОЛЖНА определить языковые предпочтения пользователя Telegram
2. КОГДА просматривается любой контент ТО система ДОЛЖНА отображать текст на выбранном языке (английский или русский)
3. КОГДА переключаются языки ТО система ДОЛЖНА немедленно обновить все элементы интерфейса и контент
4. КОГДА просматриваются категории и товары ТО система ДОЛЖНА отображать названия и описания на выбранном языке
5. ЕСЛИ контент недоступен на выбранном языке ТО система ДОЛЖНА использовать английский язык по умолчанию

### Требование 6

**Пользовательская история:** Как администратор, я хочу безопасный доступ к панели администратора через отдельную ссылку и авторизацию, чтобы только авторизованные пользователи могли управлять контентом каталога.

#### Критерии приемки

1. КОГДА администратор использует команду /login-admin в боте ТО система ДОЛЖНА предоставить специальную ссылку на админ-панель (например, url-bot/admin)
2. КОГДА пользователь переходит по админ-ссылке ТО система ДОЛЖНА отображать экран входа в админ-панель
3. КОГДА администратор вводит учетные данные ТО система ДОЛЖНА аутентифицировать через Appwrite Auth
4. КОГДА авторизация успешна ТО система ДОЛЖНА предоставить доступ к функциональности администратора
5. КОГДА неавторизованный пользователь пытается получить доступ к админ-маршрутам ТО система ДОЛЖНА перенаправить на экран входа
6. КОГДА истекает сессия администратора ТО система ДОЛЖНА требовать повторную авторизацию через Appwrite

### Требование 7

**Пользовательская история:** Как конечный пользователь, я хочу связаться с администратором по поводу конкретного товара, чтобы узнать о деталях аренды или доступности.

#### Критерии приемки

1. КОГДА просматривается страница детализации товара ТО система ДОЛЖНА отображать заметную кнопку "Связаться"
2. КОГДА нажимается кнопка связи ТО система ДОЛЖНА открыть чат Telegram, используя Telegram WebApp API
3. КОГДА открывается чат ТО система ДОЛЖНА предзаполнить сообщение с названием товара, ценой и ссылкой на товар
4. КОГДА отправляется сообщение связи ТО система ДОЛЖНА использовать пользовательское сообщение связи товара, если настроено
5. ЕСЛИ Telegram WebApp недоступен ТО система ДОЛЖНА отображать соответствующее сообщение об ошибке

### Требование 8

**Пользовательская история:** Как администратор, я хочу видеть статистику дашборда, чтобы отслеживать контент и использование каталога.

#### Критерии приемки

1. КОГДА осуществляется доступ к дашборду администратора ТО система ДОЛЖНА отображать общее количество категорий и товаров
2. КОГДА просматривается статистика дашборда ТО система ДОЛЖНА показывать количество активных и неактивных товаров
3. КОГДА находишься на дашборде ТО система ДОЛЖНА предоставить кнопки быстрых действий для добавления категорий и товаров
4. КОГДА просматривается дашборд ТО система ДОЛЖНА отображать 5 последних добавленных товаров
5. КОГДА данные дашборда загружаются ТО система ДОЛЖНА показывать соответствующие состояния загрузки

### Требование 9

**Пользовательская история:** Как пользователь, я хочу, чтобы приложение работало плавно на мобильных устройствах, чтобы я мог комфортно просматривать каталог в Telegram.

#### Критерии приемки

1. КОГДА используется приложение на мобильном устройстве ТО система ДОЛЖНА отображать контент в мобильно-оптимизированном макете
2. КОГДА взаимодействуешь с сенсорными элементами ТО система ДОЛЖНА обеспечить минимальные цели касания 44x44px
3. КОГДА загружается контент ТО система ДОЛЖНА завершать загрузку страниц менее чем за 3 секунды
4. КОГДА просматриваются изображения ТО система ДОЛЖНА оптимизировать загрузку изображений с ленивой загрузкой и форматом WebP
5. КОГДА используется приложение ТО система ДОЛЖНА поддерживать адаптивный дизайн для разных размеров экрана

### Требование 10

**Пользовательская история:** Как администратор, я хочу управлять доступностью и статусом товаров, чтобы контролировать, какие товары видны пользователям.

#### Критерии приемки

1. КОГДА редактируется товар ТО система ДОЛЖНА предоставить переключатели для доступности и активного статуса
2. КОГДА товар помечен как недоступный ТО система ДОЛЖНА отображать его со значком "Недоступен" для пользователей
3. КОГДА товар помечен как неактивный ТО система ДОЛЖНА скрыть его из публичного каталога
4. КОГДА фильтруются товары в администраторской панели ТО система ДОЛЖНА позволить фильтрацию по доступности и активному статусу
5. КОГДА массово управляются товары ТО система ДОЛЖНА предоставить варианты изменения статуса для нескольких товаров
