import{L as P,r as w,e as F,f as L,l as N,g as V,c as u,o as c,a as e,b as i,t as r,h as a,m as R,F as x,n as D,i as q,w as l,p as U,j as H,d as h,B as S}from"./DJyH1og5.js";import{_ as M}from"./UFAAJMyF.js";import{_ as G}from"./B5w-mIGz.js";import{_ as J}from"./COLhSoRh.js";import{f as K}from"./B5j1Kw8o.js";import{u as O}from"./DSnLSa3W.js";import{u as Q}from"./C5j0jcsD.js";import{u as W}from"./Cjs_hB6Y.js";import{u as X}from"./Cj-xscQC.js";import"./DPXtLpAx.js";const j=w({totalCategories:0,totalProducts:0,activeProducts:0,inactiveProducts:0,availableProducts:0,unavailableProducts:0}),z=w([]),$=w(!1),T=w(null),Y=()=>{const{fetchAllCategories:B,categories:o}=Q(),{fetchAllProducts:v,products:y}=W(),{handleError:m}=X(),_=()=>{const f=o.value||[],d=y.value||[];j.value={totalCategories:f.length,totalProducts:d.length,activeProducts:d.filter(s=>s.isActive).length,inactiveProducts:d.filter(s=>!s.isActive).length,availableProducts:d.filter(s=>s.isAvailable&&s.isActive).length,unavailableProducts:d.filter(s=>!s.isAvailable||!s.isActive).length};const n=[...d].sort((s,g)=>new Date(g.createdAt).getTime()-new Date(s.createdAt).getTime()).slice(0,5);z.value=n.map(s=>({$id:s.$id,name:s.name,pricing:s.pricing,categoryId:s.categoryId,createdAt:s.createdAt,isActive:s.isActive,isAvailable:s.isAvailable}))},p=async()=>{$.value=!0,T.value=null;try{await Promise.all([B(),v()]),_()}catch(f){console.error("Error fetching dashboard data:",f),T.value="Failed to fetch dashboard data",m(f,"Ошибка загрузки данных дашборда")}finally{$.value=!1}},k=()=>{_()};return{stats:P(j),recentProducts:P(z),loading:P($),error:P(T),fetchDashboardData:p,refreshStats:k}},Z={class:"space-y-4"},ee={class:"flex items-center justify-between"},te={class:"text-xl font-bold text-foreground"},ae={class:"text-sm text-muted-foreground mt-0.5"},se={class:"grid grid-cols-2 gap-3"},oe={class:"flex flex-col items-center text-center space-y-2 py-2"},ie={class:"text-2xl font-bold text-foreground"},re={class:"text-xs font-medium text-muted-foreground mt-0.5"},ne={class:"flex items-center space-x-2"},ce={class:"text-base font-semibold"},le={class:"space-y-2"},de={class:"flex items-center justify-between"},ue={class:"flex items-center space-x-2"},me={class:"text-base font-semibold"},fe={class:"space-y-2"},ge={class:"flex-1 space-y-2"},he=["onClick"],ve={class:"w-10 h-10 bg-muted rounded-lg flex items-center justify-center shrink-0"},_e={class:"flex-1 min-w-0"},pe={class:"text-sm font-medium text-foreground truncate"},be={class:"flex items-center space-x-2 text-xs text-muted-foreground"},xe={key:2,class:"text-center py-6 text-muted-foreground"},ye={class:"text-sm"},Se=F({__name:"dashboard",setup(B){const{t:o,locale:v}=L(),{user:y}=O(),{stats:m,recentProducts:_,loading:p,fetchDashboardData:k}=Y();N(()=>{k()});const f=n=>new Date(n).toLocaleDateString(v.value==="ru"?"ru-RU":"en-US",{year:"numeric",month:"short",day:"numeric"}),d=V(()=>[{title:o("admin.dashboard.categories"),value:m.value.totalCategories,icon:"i-lucide-folder",color:"blue",to:"/admin/categories"},{title:o("admin.dashboard.products"),value:m.value.totalProducts,icon:"i-lucide-package",color:"green",to:"/admin/products"},{title:o("admin.dashboard.active"),value:m.value.activeProducts,icon:"i-lucide-eye",color:"emerald",to:"/admin/products?filter=active"},{title:o("admin.dashboard.inactive"),value:m.value.inactiveProducts,icon:"i-lucide-eye-off",color:"red",to:"/admin/products?filter=inactive"}]);return(n,s)=>{const g=R,b=H,A=M,C=G,E=J;return c(),u("div",Z,[e("div",ee,[e("div",null,[e("h1",te,r(a(o)("admin.dashboard.title")),1),e("p",ae,r(a(o)("admin.dashboard.welcome",{name:a(y)?.name||a(y)?.email||"Admin"})),1)]),i(g,{icon:"i-lucide-refresh-cw",variant:"ghost",size:"sm",loading:a(p),onClick:a(k)},null,8,["loading","onClick"])]),e("div",se,[(c(!0),u(x,null,D(a(d),t=>(c(),q(A,{key:t.title,class:"cursor-pointer active:scale-95 transition-transform",onClick:I=>("navigateTo"in n?n.navigateTo:a(S))(t.to)},{default:l(()=>[e("div",oe,[e("div",{class:U(["w-10 h-10 rounded-lg flex items-center justify-center",{"bg-blue-100 dark:bg-blue-900/20":t.color==="blue","bg-green-100 dark:bg-green-900/20":t.color==="green","bg-emerald-100 dark:bg-emerald-900/20":t.color==="emerald","bg-red-100 dark:bg-red-900/20":t.color==="red"}])},[i(b,{name:t.icon,class:U(["w-5 h-5",{"text-blue-600 dark:text-blue-400":t.color==="blue","text-green-600 dark:text-green-400":t.color==="green","text-emerald-600 dark:text-emerald-400":t.color==="emerald","text-red-600 dark:text-red-400":t.color==="red"}])},null,8,["name","class"])],2),e("div",null,[e("p",ie,[a(p)?(c(),u(x,{key:0},[h("-")],64)):(c(),u(x,{key:1},[h(r(t.value),1)],64))]),e("p",re,r(t.title),1)])])]),_:2},1032,["onClick"]))),128))]),i(A,null,{header:l(()=>[e("div",ne,[i(b,{name:"i-lucide-zap",class:"w-4 h-4 text-primary"}),e("h3",ce,r(a(o)("admin.dashboard.quickActions")),1)])]),default:l(()=>[e("div",le,[i(g,{to:"/admin/categories/create",color:"primary",variant:"outline",block:"",icon:"i-lucide-folder-plus"},{default:l(()=>[h(r(a(o)("admin.dashboard.addCategory")),1)]),_:1}),i(g,{to:"/admin/products/create",color:"primary",variant:"outline",block:"",icon:"i-lucide-package-plus"},{default:l(()=>[h(r(a(o)("admin.dashboard.addProduct")),1)]),_:1})])]),_:1}),i(A,null,{header:l(()=>[e("div",de,[e("div",ue,[i(b,{name:"i-lucide-clock",class:"w-4 h-4 text-primary"}),e("h3",me,r(a(o)("admin.dashboard.recentProducts")),1)]),i(g,{to:"/admin/products",variant:"ghost",size:"xs",icon:"i-lucide-arrow-right",trailing:""},{default:l(()=>[h(r(a(o)("common.view_all")),1)]),_:1})])]),default:l(()=>[e("div",fe,[a(p)?(c(),u(x,{key:0},D(3,t=>e("div",{key:t,class:"flex items-center space-x-3 p-2"},[i(C,{class:"w-10 h-10 rounded"}),e("div",ge,[i(C,{class:"h-4 w-3/4"}),i(C,{class:"h-3 w-1/2"})])])),64)):a(_).length>0?(c(!0),u(x,{key:1},D(a(_),t=>(c(),u("div",{key:t.$id,class:"flex items-center space-x-3 p-2 rounded-lg active:bg-muted/50 transition-colors cursor-pointer",onClick:I=>("navigateTo"in n?n.navigateTo:a(S))(`/admin/products/${t.$id}`)},[e("div",ve,[i(b,{name:"i-lucide-package",class:"w-5 h-5 text-muted-foreground"})]),e("div",_e,[e("p",pe,r(t.name[a(v)]||t.name.en),1),e("div",be,[e("span",null,r(("formatPricing"in n?n.formatPricing:a(K))(t.pricing,a(v))),1),s[0]||(s[0]=e("span",null,"•",-1)),e("span",null,r(f(t.createdAt)),1)])]),i(E,{color:t.isActive?"success":"error",variant:"soft",size:"xs"},{default:l(()=>[h(r(t.isActive?a(o)("admin.dashboard.active"):a(o)("admin.dashboard.inactive")),1)]),_:2},1032,["color"])],8,he))),128)):(c(),u("div",xe,[i(b,{name:"i-lucide-package",class:"w-10 h-10 mx-auto mb-2 opacity-50"}),e("p",ye,r(a(o)("admin.dashboard.noRecentProducts")),1)]))])]),_:1})])}}});export{Se as default};
