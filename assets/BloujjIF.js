import{u as h}from"./BPePNRUq.js";import{g as m,r as i,U as n,B as R}from"./Cl7ulQnX.js";const o=i(null),u=i(null),r=i(!1),s=i(null),c=i(!1),k=()=>{const{account:l}=h(),d=m(()=>!!u.value),v=async e=>{r.value=!0,s.value=null;try{const a=await l.createEmailPasswordSession(e.email,e.password);u.value=a;const t=await l.get();return o.value=t,c.value=!0,!0}catch(a){return console.error("Login error:",a),s.value=a.message||"Login failed",!1}finally{r.value=!1}},g=async()=>{r.value=!0,s.value=null;try{await l.deleteSession("current")}catch(e){console.error("Logout error:",e)}finally{o.value=null,u.value=null,r.value=!1,c.value=!0,await R("/admin")}},y=async()=>{r.value=!0,s.value=null;try{const e=await l.get();o.value=e;const a=await l.getSession("current");return u.value=a,c.value=!0,!0}catch(e){return console.error("Session check error:",e),o.value=null,u.value=null,c.value=!0,!1}finally{r.value=!1}},w=async(e,a,t)=>{r.value=!0,s.value=null;try{return await l.create("unique()",e,a,t),await v({email:e,password:a})}catch(f){return console.error("Registration error:",f),s.value=f.message||"Registration failed",!1}finally{r.value=!1}},p=async(e,a)=>{r.value=!0,s.value=null;try{return await l.updatePassword(a,e),!0}catch(t){return console.error("Password update error:",t),s.value=t.message||"Password update failed",!1}finally{r.value=!1}};return{user:n(o),session:n(u),loading:n(r),error:n(s),sessionChecked:n(c),isAuthenticated:d,login:v,logout:g,checkSession:y,register:w,updatePassword:p}};export{k as u};
