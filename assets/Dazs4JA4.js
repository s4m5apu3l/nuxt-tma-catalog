import{u as p}from"./DMR9fnoT.js";import{g as m,r as c,M as o,B as h}from"./NM7yOJlJ.js";const u=c(null),n=c(null),a=c(!1),s=c(null),S=()=>{const{account:l}=p(),f=m(()=>!!n.value),i=async e=>{a.value=!0,s.value=null;try{const r=await l.createEmailPasswordSession(e.email,e.password);n.value=r;const t=await l.get();return u.value=t,!0}catch(r){return console.error("Login error:",r),s.value=r.message||"Login failed",!1}finally{a.value=!1}},d=async()=>{a.value=!0,s.value=null;try{await l.deleteSession("current")}catch(e){console.error("Logout error:",e)}finally{u.value=null,n.value=null,a.value=!1,await h("/admin")}},g=async()=>{a.value=!0,s.value=null;try{const e=await l.get();u.value=e;const r=await l.getSession("current");return n.value=r,!0}catch(e){return console.error("Session check error:",e),u.value=null,n.value=null,!1}finally{a.value=!1}},y=async(e,r,t)=>{a.value=!0,s.value=null;try{return await l.create("unique()",e,r,t),await i({email:e,password:r})}catch(v){return console.error("Registration error:",v),s.value=v.message||"Registration failed",!1}finally{a.value=!1}},w=async(e,r)=>{a.value=!0,s.value=null;try{return await l.updatePassword(r,e),!0}catch(t){return console.error("Password update error:",t),s.value=t.message||"Password update failed",!1}finally{a.value=!1}};return{user:o(u),session:o(n),loading:o(a),error:o(s),isAuthenticated:f,login:i,logout:d,checkSession:g,register:y,updatePassword:w}};export{S as u};
